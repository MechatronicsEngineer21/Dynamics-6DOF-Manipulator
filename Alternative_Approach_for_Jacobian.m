%% DH and Inertia Parameters of robot
alpha = [pi/2,0,0,pi/2,-pi/2,0];
a = [0,0.410,.340,0,0,0];
d = [.179,0,0,.188,.132,0];
m = [4.043687892216430,4.088351020081470,2.975514330882000,2.005251413706830,1.580964077451070,0.312204788418883];
p_c1 = [5.62863246619805e-06,	-0.0712754141025166,	-0.00583821731829928];
p_c2 = [0.266884576505637,	6.57683680493905e-06	,0.145260394562513];
p_c3 = [0.237472823221729,	-2.00826081189764e-06,	0.0376164502968732];
p_c4 = [-0.00183715117493422,	-0.0365459234829408,	0.172476350166275];
p_c5 = [0.00232838749144237,	0.0384258837201684,	0.123429863395004];
p_c6 = [0.000634869947333528,	0.00391637711202809,	0.120490768542163];
% 
% [Ixx,Iyy, Izz Tyz, Ixz, Ixy]
% 0.0256365144777215	0.00665469331160818	0.0250354565670247	-0.000723537076243379	1.82000648689342e-07	9.11011344785925e-07
In_1= [0.0256365144777215, 9.11011344785925e-07,1.82000648689342e-07;
9.11011344785925e-07, 0.00665469331160818,-0.000723537076243379;
1.82000648689342e-07, -0.000723537076243379, 	0.0250354565670247];

% 0.0934242825775859	0.429895593447408	0.343952026019285	-3.66364099206361e-06	-0.158696051806179	-7.49373409208807e-06
In_2= [0.0934242825775859, -7.49373409208807e-06, -0.158696051806179;
-7.49373409208807e-06, 0.429895593447408,-3.66364099206361e-06;
-0.158696051806179, -3.66364099206361e-06, 0.343952026019285];

% 0.00796511011804721	0.198641151365072	0.194685517188124	3.91874159242292e-07	-0.0258905573571414	-6.23480885898958e-07
In_3 = [0.00796511011804721, -6.23480885898958e-07, -0.0258905573571414;
-6.23480885898958e-07, 0.198641151365072, 3.91874159242292e-07;
-0.0258905573571414, 3.91874159242292e-07,0.194685517188124];


% 0.0643547214988473	0.0620233656652383	0.00427910029465841	0.0129916682948349	0.000632738514403877	-0.000137312641834570
In_4= [0.0643547214988473, -0.000137312641834570, 0.000632738514403877;
-0.000137312641834570, 0.0620233656652383, 0.0129916682948349;
0.000632738514403877,0.0129916682948349, 0.00427910029465841	];

% 0.0277827074304922	0.0257145715219778	0.00355361777275285	-0.00773249663034194	-0.000451742327448627	-0.000144088686954488
In_5= [0.0277827074304922, -0.000144088686954488, -0.000451742327448627;
-0.000144088686954488, 0.0257145715219778, -0.00773249663034194;
-0.000451742327448627, -0.00773249663034194, 0.00355361777275285];

% 0.00464887224718288	0.00470493042096833	0.000154844733533007	-0.000149950574946370	-2.44987020649305e-05	1.01430408305949e-05
In_6= [0.00464887224718288, 1.01430408305949e-05, -2.44987020649305e-05;
1.01430408305949e-05, 0.00470493042096833,-0.000149950574946370;
-2.44987020649305e-05, -0.000149950574946370, 0.000154844733533007];

%% PARAMETERs AND SYMBOLs
g = 9.806650000000000;
alpha_0=alpha(1);alpha_1=alpha(2);alpha_2=alpha(3);alpha_3=alpha(4);alpha_4=alpha(5);alpha_5=alpha(6);
a_0=a(1);a_1=a(2);a_2=a(3);a_3=a(4);a_4=a(5);a_5=a(6);
d_1=d(1);d_2=d(2);d_3=d(3);d_4=d(4);d_5=d(5);d_6=d(6);
p_cx1=p_c1(1);p_cy1=p_c1(2);p_cz1=p_c1(3);
p_cx2=p_c2(1);p_cy2=p_c2(2);p_cz2=p_c2(3);
p_cx3=p_c3(1);p_cy3=p_c3(2);p_cz3=p_c3(3);
p_cx4=p_c4(1);p_cy4=p_c4(2);p_cz4=p_c4(3);
p_cx5=p_c5(1);p_cy5=p_c5(2);p_cz5=p_c5(3);
p_cx6=p_c6(1);p_cy6=p_c6(2);p_cz6=p_c6(3);
m_1=m(1);m_2=m(2);m_3=m(3);m_4=m(4);m_5=m(5);m_6=m(6);
q_1=sym('q_1');q_2=sym('q_2');q_3=sym('q_3');q_4=sym('q_4');q_5=sym('q_5');q_6=sym('q_6');
dq_1=sym('dq_1');dq_2=sym('dq_2');dq_3=sym('dq_3');dq_4=sym('dq_4');dq_5=sym('dq_5');dq_6=sym('dq_6');
ddq_1=sym('ddq_1');ddq_2=sym('ddq_2');ddq_3=sym('ddq_3');ddq_4=sym('ddq_4');ddq_5=sym('ddq_5');ddq_6=sym('ddq_6');
%% ROTATION MATRICEs
R_1= [cos(q_1), -sin(q_1)*cos(alpha_0), sin(q_1)*sin(alpha_0);
      sin(q_1), cos(q_1)*cos(alpha_0), -cos(q_1)*sin(alpha_0);
      0,         sin(alpha_0),           cos(alpha_0)];
R_2= [cos(q_2), -sin(q_2)*cos(alpha_1), sin(q_2)*sin(alpha_1);
      sin(q_2), cos(q_2)*cos(alpha_1), -cos(q_2)*sin(alpha_1);
      0,         sin(alpha_1),           cos(alpha_1)];
R_3=[cos(q_3), -sin(q_3)*cos(alpha_2), sin(q_3)*sin(alpha_2);
      sin(q_3), cos(q_3)*cos(alpha_2), -cos(q_3)*sin(alpha_2);
      0,         sin(alpha_2),           cos(alpha_2)];
R_4=[cos(q_4), -sin(q_4)*cos(alpha_3), sin(q_4)*sin(alpha_3);
      sin(q_4), cos(q_4)*cos(alpha_3), -cos(q_4)*sin(alpha_3);
      0,         sin(alpha_3),           cos(alpha_3)];
R_5= [cos(q_5), -sin(q_5)*cos(alpha_4), sin(q_5)*sin(alpha_4) ;
      sin(q_5), cos(q_5)*cos(alpha_4), -cos(q_5)*sin(alpha_4);
      0,         sin(alpha_4),           cos(alpha_4)];
R_6=[cos(q_6), -sin(q_6)*cos(alpha_5), sin(q_6)*sin(alpha_5) ;
      sin(q_6), cos(q_6)*cos(alpha_5), -cos(q_6)*sin(alpha_5);
      0,         sin(alpha_5),           cos(alpha_5)];
%% POSITION VECTORs
p_1=[a_0*cos(q_1);a_0*sin(q_1);d_1];
p_2=[a_1*cos(q_2);a_1*sin(q_2);d_2];
p_3=[a_2*cos(q_3);a_2*sin(q_3);d_3];
p_4=[a_3*cos(q_4);a_3*sin(q_4);d_4];
p_5=[a_4*cos(q_5);a_4*sin(q_5);d_5];
p_6=[a_5*cos(q_6);a_5*sin(q_6);d_6];
A1 = [[R_1,p_1]; 0 0 0 1];
A2=[[R_2,p_2];0,0,0,1];
A3=[[R_3,p_3];0,0,0,1];
A4=[[R_4,p_4];0,0,0,1];
A5=[[R_5,p_5];0,0,0,1];
A6=[[R_6,p_6];0,0,0,1];
t12=(A1*A2);
t13=(t12*A3);
t14=(t13*A4);
t15=(t14*A5);
t16=(t15*A6);
o0=[0 0 0];
o1=A1(1:3,4)';
o2=t12(1:3,4)';
o3=t13(1:3,4)';
o4=t14(1:3,4)';
o5=t15(1:3,4)';
o6=t16(1:3,4)';
%% SYSTEM's STATEs
q=[q_1;q_2;q_3;q_4;q_5;q_6];
dq=[dq_1;dq_2;dq_3;dq_4;dq_5;dq_6];
ddq=[ddq_1;ddq_2;ddq_3;ddq_4;ddq_5;ddq_6];

%% ROTATION MATRICEs FROM BASE

R_20=R_1*R_2;
R_30=R_20*R_3;
R_40=R_30*R_4;
R_50=R_40*R_5;
R_60=R_50*R_6;

p_c1=o0 + R_1* p_c1';
p_c2=o1 + R_2* p_c2';
p_c3=o2 + R_3* p_c3';
p_c4=o3 + R_4* p_c4';
p_c5=o4 + R_5* p_c5';
p_c6=o5 + R_6* p_c6';
% %% LINEAR PART of JACOBIANs
J_v1 = jacobian(p_c1(3,:)', q);
J_v2 = jacobian(p_c2(3,:)', q);
J_v3 = jacobian(p_c3(3,:)', q);
J_v4 = jacobian(p_c4(3,:)', q);
J_v5 = jacobian(p_c5(3,:)', q);
J_v6 = jacobian(p_c6(3,:)', q);
J_v61= jacobian(p_c6(3,:), q);

%% ANGULAR PART of JACOBIANs
J_o1=[[0;0;1],zeros(3,5)];
J_o2=[[0;0;1],R_1(:,3),zeros(3,4)];
J_o3=[[0;0;1],R_1(:,3),R_20(:,3),zeros(3,3)];
J_o4=[[0;0;1],R_1(:,3),R_20(:,3),R_30(:,3),zeros(3,2)];
J_o5=[[0;0;1],R_1(:,3),R_20(:,3),R_30(:,3),R_40(:,3),zeros(3,1)];
J_o6=[[0;0;1],R_1(:,3),R_20(:,3),R_30(:,3),R_40(:,3),R_50(:,3)];

%% JACOBIAN MATRIX OF THE END-EFFECTOR
Jacobi = [J_o3;J_v3];

q_val = [0.1; 0.2; 0.3; 0.4; 0.5; 0.6];  
J_value=subs(Jacobi, q,q_val);
J_value=double(J_value);